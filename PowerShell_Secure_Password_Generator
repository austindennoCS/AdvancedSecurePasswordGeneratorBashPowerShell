# PowerShell script to generate secure passwords with advanced features

<#
.SYNOPSIS
    Generates secure passwords based on user-defined parameters.
.DESCRIPTION
    This script generates secure passwords with options to include symbols and numbers.
.PARAMETER length
    Specifies the desired length of the password. Length must be between 10 and 16 characters.
.PARAMETER includeSymbols
    Switch to include symbols in the password.
.PARAMETER includeNumbers
    Switch to include numbers in the password.
.PARAMETER count
    Specifies the number of passwords to generate. Must be between 1 and 1000.
.EXAMPLE
    .\Generate-Password.ps1
    Prompts the user for input and generates the desired passwords.
#>

function Generate-Password {
    param (
        [int]$length = 16,
        [switch]$includeSymbols,
        [switch]$includeNumbers,
        [int]$count = 1
    )

    $lower = "abcdefghijklmnopqrstuvwxyz"
    $upper = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
    $numbers = "0123456789"
    $symbols = "!@#$%^&*()_+<>?"
    $chars = $lower + $upper

    if ($includeNumbers) { $chars += $numbers }
    if ($includeSymbols) { $chars += $symbols }

    for ($i = 1; $i -le $count; $i++) {
        $password = -join ((1..$length) | ForEach-Object { $chars[(Get-Random -Maximum $chars.Length)] })
        Write-Output "Generated Password ${i}: $password"
    }
}

# User Input for Password Parameters
do {
    $length = Read-Host "Enter desired password length (between 10 and 16, default 16)"
    $length = if ($length -match '^\d+$') { [int]$length } else { 16 }
    if ($length -lt 10 -or $length -gt 16) {
        Write-Output "Password length must be between 10 and 16 characters. Please try again."
    }
} while ($length -lt 10 -or $length -gt 16)

$symbols = Read-Host "Include symbols? (y/n, default n)"
$includeSymbols = if ($symbols -eq 'y') { $true } else { $false }

$numbers = Read-Host "Include numbers? (y/n, default y)"
$includeNumbers = if ($numbers -eq 'n') { $false } else { $true }

do {
    $count = Read-Host "How many passwords to generate? (between 1 and 1000, default 1)"
    $count = if ($count -match '^\d+$') { [int]$count } else { 1 }
    if ($count -lt 1 -or $count -gt 1000) {
        Write-Output "You must generate between 1 and 1000 passwords. Please try again."
    }
} while ($count -lt 1 -or $count -gt 1000)

# Generate Passwords
Generate-Password -length $length -includeSymbols:$includeSymbols -includeNumbers:$includeNumbers -count $count
